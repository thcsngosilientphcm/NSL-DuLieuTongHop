<!doctype html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>NSL - Hệ Thống Quản Lý</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      /* Nền chính Deep Blue */
      body {
        background: linear-gradient(135deg, #0f2027 0%, #203a43 50%, #2c5364 100%);
      }
      .no-select { -webkit-user-select: none; user-select: none; cursor: default; }

      /* Hiệu ứng kính cho Sidebar (Đã sửa thứ tự CSS) */
      .glass-sidebar {
        background: rgba(255, 255, 255, 0.05);
        /* Đặt -webkit- lên trước theo yêu cầu của VS Code */
        -webkit-backdrop-filter: blur(10px);
        backdrop-filter: blur(10px);
        
        border-right: 1px solid rgba(255, 255, 255, 0.1);
      }

      /* Hiệu ứng kính cho Content (Đã sửa thứ tự CSS) */
      .glass-panel {
        background: rgba(255, 255, 255, 0.03);
        /* Đặt -webkit- lên trước */
        -webkit-backdrop-filter: blur(16px);
        backdrop-filter: blur(16px);
        
        border: 1px solid rgba(255, 255, 255, 0.1);
        box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
      }

      /* Scrollbar tùy chỉnh */
      ::-webkit-scrollbar { width: 6px; }
      ::-webkit-scrollbar-track { background: transparent; }
      ::-webkit-scrollbar-thumb { background: rgba(255, 255, 255, 0.2); border-radius: 3px; }
      ::-webkit-scrollbar-thumb:hover { background: rgba(255, 255, 255, 0.4); }

      /* Animation cho submenu */
      .submenu { transition: max-height 0.3s ease-out, opacity 0.3s ease-out; max-height: 0; opacity: 0; overflow: hidden; }
      .submenu.open { max-height: 200px; opacity: 1; }
    </style>
  </head>
  <body class="h-screen w-screen overflow-hidden text-slate-200 font-sans no-select flex">
    
    <aside id="sidebar" class="glass-sidebar h-full w-[16%] transition-all duration-300 ease-in-out flex flex-col relative z-20">
      
      <div class="h-16 flex items-center justify-center border-b border-white/10 relative">
        <div class="flex items-center gap-2 overflow-hidden px-2">
          <div class="min-w-[32px] h-8 w-8 bg-cyan-500 rounded-lg flex items-center justify-center shadow-lg shadow-cyan-500/20">
            <svg class="w-5 h-5 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" /></svg>
          </div>
          <span class="font-bold text-lg text-white tracking-wide whitespace-nowrap sidebar-text">NSL DATA</span>
        </div>
        
        <button id="toggle-sidebar" title="Thu gọn/Mở rộng menu" aria-label="Thu gọn menu" class="absolute -right-3 top-1/2 -translate-y-1/2 w-6 h-6 bg-cyan-600 rounded-full flex items-center justify-center text-white shadow-md hover:bg-cyan-500 transition-colors z-50">
          <svg class="w-3 h-3 transition-transform duration-300" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M15 19l-7-7 7-7" /></svg>
        </button>
      </div>

      <nav class="flex-1 overflow-y-auto py-4 space-y-1 px-2">
        
        <div class="menu-group">
          <button title="Quản lý trường học" class="w-full flex items-center justify-between px-3 py-2.5 rounded-lg hover:bg-white/10 transition-colors group" onclick="toggleSubmenu('menu-qlth')">
            <div class="flex items-center gap-3">
              <svg class="w-5 h-5 text-cyan-400 min-w-[20px]" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253" /></svg>
              <span class="sidebar-text font-medium text-sm">QL Trường Học</span>
            </div>
            <svg class="w-3 h-3 text-slate-400 sidebar-text transition-transform group-hover:text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" /></svg>
          </button>
          <div id="menu-qlth" class="submenu pl-9 space-y-1">
            <button class="w-full text-left px-3 py-2 text-xs text-slate-300 hover:text-white hover:bg-white/5 rounded-md transition-colors sidebar-text">Nhập điểm</button>
            <button class="w-full text-left px-3 py-2 text-xs text-slate-300 hover:text-white hover:bg-white/5 rounded-md transition-colors sidebar-text">GVCN Nhận xét</button>
          </div>
        </div>

        <div class="menu-group mt-2">
          <button title="Trang trường" class="w-full flex items-center justify-between px-3 py-2.5 rounded-lg hover:bg-white/10 transition-colors group" onclick="toggleSubmenu('menu-school')">
            <div class="flex items-center gap-3">
              <svg class="w-5 h-5 text-purple-400 min-w-[20px]" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 14v3m4-3v3m4-3v3M3 21h18M3 10h18M3 7l9-4 9 4M4 10h16v11H4V10z" /></svg>
              <span class="sidebar-text font-medium text-sm">Trang Trường</span>
            </div>
            <svg class="w-3 h-3 text-slate-400 sidebar-text transition-transform group-hover:text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" /></svg>
          </button>
          <div id="menu-school" class="submenu pl-9 space-y-1">
            <button class="w-full text-left px-3 py-2 text-xs text-slate-300 hover:text-white hover:bg-white/5 rounded-md transition-colors sidebar-text">Ký số học bạ</button>
          </div>
        </div>

        <button onclick="switchView('update')" title="Kiểm tra cập nhật" id="btn-update" class="w-full flex items-center gap-3 px-3 py-2.5 rounded-lg bg-blue-600/20 text-blue-300 border border-blue-500/30 hover:bg-blue-600/30 transition-all mt-6 shadow-[0_0_10px_rgba(59,130,246,0.2)]">
          <svg class="w-5 h-5 min-w-[20px]" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" /></svg>
          <span class="sidebar-text font-medium text-sm">Cập nhật</span>
        </button>

        <button title="Trợ giúp" class="w-full flex items-center gap-3 px-3 py-2.5 rounded-lg hover:bg-white/10 transition-colors text-slate-300 hover:text-white">
          <svg class="w-5 h-5 min-w-[20px]" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18.364 5.636l-3.536 3.536m0 5.656l3.536 3.536M9.172 9.172L5.636 5.636m3.536 9.192l-3.536 3.536M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-5 0a4 4 0 11-8 0 4 4 0 018 0z" /></svg>
          <span class="sidebar-text font-medium text-sm">Trợ giúp</span>
        </button>

      </nav>

      <div class="p-4 border-t border-white/10">
        <div class="flex items-center gap-3">
          <div class="w-8 h-8 rounded-full bg-gradient-to-tr from-yellow-400 to-orange-500 flex items-center justify-center text-xs font-bold text-white shadow-lg">AD</div>
          <div class="sidebar-text overflow-hidden">
            <p class="text-sm font-medium text-white truncate">Admin</p>
            <p class="text-xs text-slate-400 truncate">Phiên bản: <span id="app-version">...</span></p>
          </div>
        </div>
      </div>
    </aside>

    <main class="flex-1 relative flex flex-col h-full bg-black/20 p-6 overflow-hidden">
      
      <header class="flex justify-between items-center mb-6">
        <h2 id="page-title" class="text-2xl font-bold text-white drop-shadow-md">Trung tâm cập nhật</h2>
        <div class="flex gap-4">
             <div class="glass-panel px-4 py-1 rounded-full text-xs text-slate-300">Trạng thái: <span class="text-green-400">Online</span></div>
        </div>
      </header>

      <section id="view-update" class="flex-1 flex gap-6">
        
        <div class="w-1/3 glass-panel rounded-2xl p-6 flex flex-col gap-6 h-fit">
            <div class="text-center">
                <div class="inline-flex p-4 rounded-full bg-blue-500/20 mb-4 ring-1 ring-blue-400/50 shadow-[0_0_20px_rgba(59,130,246,0.3)]">
                    <svg class="w-10 h-10 text-blue-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12" /></svg>
                </div>
                <h3 class="text-xl font-bold text-white">Kiểm tra cập nhật</h3>
                <p class="text-sm text-slate-400 mt-2">Hệ thống sẽ tự động tải bản vá lỗi và tính năng mới từ GitHub.</p>
            </div>
            
            <div class="bg-black/30 rounded-lg p-4 border border-white/5">
                <div class="flex justify-between text-sm mb-2">
                    <span class="text-slate-400">Phiên bản hiện tại:</span>
                    <span id="current-version-display" class="font-mono text-white font-bold">...</span>
                </div>
                <div class="flex justify-between text-sm">
                    <span class="text-slate-400">Kênh phát hành:</span>
                    <span class="text-yellow-400 font-medium">Production</span>
                </div>
            </div>

            <button id="manual-check-btn" title="Bấm để kiểm tra" class="group relative w-full py-3 bg-gradient-to-r from-blue-600 to-cyan-600 rounded-xl text-white font-bold shadow-lg hover:shadow-cyan-500/40 transition-all active:scale-95 overflow-hidden">
                <div class="absolute inset-0 bg-white/20 translate-y-full group-hover:translate-y-0 transition-transform duration-300"></div>
                <span class="relative flex items-center justify-center gap-2">
                    <svg class="w-5 h-5 animate-spin hidden" id="loading-icon" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>
                    <span id="btn-text">Kiểm tra ngay</span>
                </span>
            </button>
        </div>

        <div class="flex-1 glass-panel rounded-2xl p-0 flex flex-col overflow-hidden border border-slate-700/50 bg-[#0c1218]/80">
            <div class="bg-white/5 px-4 py-2 border-b border-white/5 flex items-center justify-between">
                <span class="text-xs font-mono text-slate-400">Console Output</span>
                <div class="flex gap-1.5">
                    <div class="w-2.5 h-2.5 rounded-full bg-red-500/50"></div>
                    <div class="w-2.5 h-2.5 rounded-full bg-yellow-500/50"></div>
                    <div class="w-2.5 h-2.5 rounded-full bg-green-500/50"></div>
                </div>
            </div>
            
            <div id="update-log" class="flex-1 p-4 font-mono text-sm text-green-400/90 overflow-y-auto space-y-1">
                <div class="text-slate-500 italic">>> Sẵn sàng kiểm tra phiên bản mới...</div>
            </div>
            
            <div id="progress-container" class="hidden h-1 w-full bg-slate-800">
                <div id="progress-bar" class="h-full bg-cyan-500 w-0 transition-all duration-300 shadow-[0_0_10px_#06b6d4]"></div>
            </div>
        </div>

      </section>

      <section id="view-other" class="hidden flex-1 items-center justify-center">
        <div class="text-center opacity-50">
            <svg class="w-20 h-20 text-white mx-auto mb-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10" /></svg>
            <p class="text-xl text-white font-light">Chức năng đang phát triển</p>
        </div>
      </section>

    </main>

    <script type="module" src="/src/main.js"></script>
    <script>
      // Hàm xử lý UI Sidebar
      const sidebar = document.getElementById('sidebar');
      const toggleBtn = document.getElementById('toggle-sidebar');
      const texts = document.querySelectorAll('.sidebar-text');
      let isCollapsed = false;

      toggleBtn.addEventListener('click', () => {
        isCollapsed = !isCollapsed;
        if (isCollapsed) {
          sidebar.classList.remove('w-[16%]');
          sidebar.classList.add('w-16');
          toggleBtn.querySelector('svg').style.transform = 'rotate(180deg)';
          texts.forEach(t => t.style.display = 'none');
          document.querySelectorAll('.submenu').forEach(s => s.classList.remove('open'));
        } else {
          sidebar.classList.add('w-[16%]');
          sidebar.classList.remove('w-16');
          toggleBtn.querySelector('svg').style.transform = 'rotate(0deg)';
          setTimeout(() => texts.forEach(t => t.style.display = 'block'), 150);
        }
      });

      window.toggleSubmenu = (id) => {
        if (isCollapsed) return;
        const el = document.getElementById(id);
        const isOpen = el.classList.contains('open');
        document.querySelectorAll('.submenu').forEach(s => s.classList.remove('open'));
        if (!isOpen) el.classList.add('open');
      };

      window.switchView = (viewName) => {
          const updateView = document.getElementById('view-update');
          const otherView = document.getElementById('view-other');
          const title = document.getElementById('page-title');

          if (viewName === 'update') {
              updateView.classList.remove('hidden');
              updateView.classList.add('flex');
              otherView.classList.add('hidden');
              title.innerText = "Trung tâm cập nhật";
          } else {
              updateView.classList.add('hidden');
              updateView.classList.remove('flex');
              otherView.classList.remove('hidden');
              otherView.classList.add('flex');
              title.innerText = "Quản lý dữ liệu";
          }
      };
    </script>
  </body>
</html>